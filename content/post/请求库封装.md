---
title: "请求库封装"
date: 2024-04-12T21:39:59+08:00
draft: true
---

## 为什么要封装axios
axios 很成熟，几乎是所有前端项目的标配，但是它也有一些缺失的功能
1. 请求重试
2. 请求缓存
3. 请求幂等
满足公司内部规范
1. 适配接口返回统一格式
2. token 参数的适配

## 设计
我把请求库分为三层
1. 基础层：设置请求头，处理请求参数，处理响应数据等
2. 功能层：重试、缓存、幂等
3. 业务层：与业务强相关的功能，适配返回格式、token参数等
还有一个模版代码生成工具，可以根据接口文档自动生成请求代码。

### 基础层
我考虑到基础层这块儿，不一定会使用 axios，在浏览器中还可能会使用 fetch，在小程序中会使用原生的 wx.request，我应用 DIP 原则，更具功能层提供接口实现get、post 方法，并提供统一的请求参数格式。

### 功能层
定义基础层的实现，基于基础层实现：接口的重试、缓存、幂等

### 业务层
实现与业务/公司规范相关的功能，比如适配接口返回格式、token参数等

### 模版代码生成工具
根据接口文档自动生成请求代码，减少重复代码，提高开发效率。


